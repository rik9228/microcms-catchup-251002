# ğŸ“£ ä»–ã®æ¡ˆä»¶ã§ä½¿ç”¨ã™ã‚‹å ´åˆ

```javascript
/**
 *  endpoint: ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
 *  listSelectorï¼š æŒ¿å…¥ã™ã‚‹å¯¾è±¡è¦ç´ 
 * 
**/
async function fetchList(endpoint, listSelector) {
  const listEl = document.querySelector(listSelector);
  if (!listEl) return;

  try {
    const res = await fetch(endpoint, {
      headers: { "X-API-KEY": API_KEY }
    });
    const data = await res.json();

    listEl.innerHTML = "";

    if (data.contents.length === 0) {
      listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>";
      return;
    }

    data.contents.forEach(item => {
      const li = document.createElement("li");
      li.innerHTML = `
        <a href="/post/?id=${item.id}">${item.title}</a>
        <small>${item.publishedAt?.slice(0,10) || "æ—¥ä»˜æœªå®š"}</small>
      `;
      listEl.appendChild(li);
    });
  } catch (err) {
    console.error("å–å¾—ã‚¨ãƒ©ãƒ¼:", err);
    listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</li>";
  }
}
```

### ä½¿ã„æ–¹ä¾‹ï¼š

```javascript
// ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§
fetchList(`https://${SERVICE_DOMAIN}.microcms.io/api/v1/news`, "#news-list");

// ãƒ–ãƒ­ã‚°ä¸€è¦§
fetchList(`https://${SERVICE_DOMAIN}.microcms.io/api/v1/blog`, "#blog-list");
```

## 2. UIéƒ¨åˆ†ã‚’ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§å·®ã—æ›¿ãˆã‚‹

æ¡ˆä»¶ã”ã¨ã«ã€Œã‚¿ã‚¤ãƒˆãƒ«ã ã‘ã€ã€Œã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãã€ã€Œã‚«ãƒ†ã‚´ãƒªã‚‚è¡¨ç¤ºã€ãªã©è¡¨ç¤ºå†…å®¹ãŒç•°ãªã‚Šã¾ã™ã€‚

ãã®å ´åˆã¯ æç”»å‡¦ç†ã‚’å¤–ã‹ã‚‰æ¸¡ã™ ã“ã¨ã§æŸ”è»Ÿã«å¯¾å¿œã§ãã¾ã™ã€‚

```javascript
/**
 *  endpoint: ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
 *  listSelectorï¼š æŒ¿å…¥ã™ã‚‹å¯¾è±¡è¦ç´ 
 *  renderItem : ç”Ÿæˆã™ã‚‹DOMè¦ç´ 
**/
async function fetchList({ endpoint, listSelector, renderItem }) {
  const listEl = document.querySelector(listSelector);
  if (!listEl) return;

  try {
    const res = await fetch(endpoint, { headers: { "X-API-KEY": API_KEY } });
    const data = await res.json();

    listEl.innerHTML = "";

    if (data.contents.length === 0) {
      listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>";
      return;
    }

    data.contents.forEach(item => {
      const li = document.createElement("li");
      li.innerHTML = renderItem(item);
      listEl.appendChild(li);
    });
  } catch (err) {
    console.error("å–å¾—ã‚¨ãƒ©ãƒ¼:", err);
    listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</li>";
  }
}
```

### ä½¿ã„æ–¹ä¾‹ï¼š

```javascript
// ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰
fetchList({
  endpoint: `https://${SERVICE_DOMAIN}.microcms.io/api/v1/news`,
  listSelector: "#news-list",
  renderItem: (item) => `
    <a href="/news/post/?id=${item.id}">
      ${item.title}
    </a>
    <small>${item.publishedAt?.slice(0,10) || "æ—¥ä»˜æœªå®š"}</small>
  `
});

// ãƒ–ãƒ­ã‚°ä¸€è¦§ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãï¼‰
fetchList({
  endpoint: `https://${SERVICE_DOMAIN}.microcms.io/api/v1/blog`,
  listSelector: "#blog-list",
  renderItem: (item) => `
    <a href="/blog/post/?id=${item.id}">
      <img src="${item.thumbnail?.url || "dummy.jpg"}" alt="${item.title}">
      <h3>${item.title}</h3>
    </a>
  `
});
```

## 3. è¨­å®šã‚’å…±é€šåŒ–ã™ã‚‹

`SERVICE_DOMAIN` ã‚„ `API_KEY` ã¯è¤‡æ•°ç®‡æ‰€ã§ä½¿ã†ãŸã‚ã€è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨æ„ã™ã‚‹ã¨åˆ†ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚

```javascript
const CONFIG = {
  serviceDomain: window.ENV.MICROCMS_SERVICE_DOMAIN,
  apiKey: window.ENV.MICROCMS_API_KEY
};

```


### ä½¿ç”¨ä¾‹ï¼š
```javascript
async function fetchList({ endpoint, listSelector, renderItem }) {
  const listEl = document.querySelector(listSelector);
  if (!listEl) return;

  try {
    const res = await fetch(endpoint, { headers: { "X-API-KEY": CONFIG.apikey } }); // configã‚ˆã‚Šå‚ç…§
    const data = await res.json();

    listEl.innerHTML = "";

    if (data.contents.length === 0) {
      listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</li>";
      return;
    }

    data.contents.forEach(item => {
      const li = document.createElement("li");
      li.innerHTML = renderItem(item);
      listEl.appendChild(li);
    });
  } catch (err) {
    console.error("å–å¾—ã‚¨ãƒ©ãƒ¼:", err);
    listEl.innerHTML = "<li>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</li>";
  }
}
```

```javascript
// ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§
fetchList(`https://${CONFIG.serviceDomain}.microcms.io/api/v1/news`, "#news-list");
```

-> DOMã®è¡¨ç¤ºç¢ºèªãŒã§ãã¦ã„ã‚‹ã¨OKï¼